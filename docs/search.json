[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Miscellaneous code and dynamic documents."
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "",
    "text": "What does the weighting by PPH4 do to tissue partitioned BMI instruments? Let’s simulate some tissue partitioned BMI MR results.\n\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(ggrepel)\nlibrary(genepi.utils)\nlibrary(tibble)\nlibrary(knitr)"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#motivation",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#motivation",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "",
    "text": "What does the weighting by PPH4 do to tissue partitioned BMI instruments? Let’s simulate some tissue partitioned BMI MR results.\n\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(ggrepel)\nlibrary(genepi.utils)\nlibrary(tibble)\nlibrary(knitr)"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#bmi-data",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#bmi-data",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "BMI data",
    "text": "BMI data\nFirst load the BMI GWAS.\n\nbmi    &lt;- readRDS(file.path(TPMR_DIR, \"output\", \"tmp_objects\", \"obj_bmi.RDS\"))\nclumps &lt;- clump(as.data.table(bmi), p1=5e-8, r2=0.001, kb=10000, plink2=PLINK2, plink_ref=UKBB_REFERENCE)[index==TRUE]\nbmi    &lt;- subset_gwas(bmi, clumps$rsid)\nkable(head(clumps, 5), caption = \"BMI lead variants\")\n\n\nBMI lead variants\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nrsid\nchr\nbp\nea\noa\neaf\nbeta\nse\np\nn\nncase\ntrait\nid\nstrand\nimputed\ninfo\nq\nq_p\ni2\nproxy_rsid\nproxy_chr\nproxy_bp\nproxy_ea\nproxy_oa\nproxy_eaf\nproxy_r2\nsnp\nindex\nclump\n\n\n\n\nrs10007906\n4\n31023610\nA\nC\n0.360300\n0.0133000\n0.0018000\n0\n686479\nNA\nbmi\ncombined_bmi_giant_ukb_annot.txt\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nrs10007906\nTRUE\n291\n\n\nrs1000940\n17\n5283252\nA\nG\n0.701300\n-0.0154000\n0.0018000\n0\n794558\nNA\nbmi\ncombined_bmi_giant_ukb_annot.txt\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nrs1000940\nTRUE\n142\n\n\nrs1007934\n14\n73463479\nA\nG\n0.415000\n-0.0120000\n0.0017000\n0\n692411\nNA\nbmi\ncombined_bmi_giant_ukb_annot.txt\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nrs1007934\nTRUE\n407\n\n\nrs10125137\n9\n118644190\nT\nC\n0.641786\n-0.0117273\n0.0020523\n0\n463005\nNA\nbmi\ncombined_bmi_giant_ukb_annot.txt\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nrs10125137\nTRUE\n811\n\n\nrs10131890\n14\n97258752\nA\nC\n0.950300\n-0.0222000\n0.0039000\n0\n691777\nNA\nbmi\ncombined_bmi_giant_ukb_annot.txt\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nrs10131890\nTRUE\n846"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#heart-failure-data",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#heart-failure-data",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "Heart failure data",
    "text": "Heart failure data\nLoad the heart failure GWAS.\n\nhf &lt;- readRDS(file.path(TPMR_DIR, \"output\", \"tmp_objects\", \"obj_hf_allcause.RDS\"))\nhf &lt;- subset_gwas(hf, clumps$rsid)"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#harmonise-the-datasets",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#harmonise-the-datasets",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "Harmonise the datasets",
    "text": "Harmonise the datasets\n\nh &lt;- MR(bmi, hf)\nkable(head(as.data.table(h),5), caption = \"Harmonised BMI:HF dataset\")\n\n\nHarmonised BMI:HF dataset\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nrsid\nchr\nbp\nea\noa\nbx\nbxse\npx\nby\nbyse\npy\nproxy_e_snp\nproxy_o_snp\nindex_snp\ngroup\nld_info\nexposure\noutcome\n\n\n\n\nrs10007906_C_A\n4\n31023610\nA\nC\n0.0133000\n0.0018000\n0\n0.0039\n0.0051\n0.44980\nNA\nNA\nTRUE\nNA\nFALSE\nbmi\nhf_allcause\n\n\nrs1000940_G_A\n17\n5283252\nA\nG\n-0.0154000\n0.0018000\n0\n0.0011\n0.0050\n0.82970\nNA\nNA\nTRUE\nNA\nFALSE\nbmi\nhf_allcause\n\n\nrs1007934_G_A\n14\n73463479\nA\nG\n-0.0120000\n0.0017000\n0\n-0.0092\n0.0049\n0.05931\nNA\nNA\nTRUE\nNA\nFALSE\nbmi\nhf_allcause\n\n\nrs10125137_C_T\n9\n118644190\nT\nC\n-0.0117273\n0.0020523\n0\n0.0033\n0.0049\n0.50820\nNA\nNA\nTRUE\nNA\nFALSE\nbmi\nhf_allcause\n\n\nrs10131890_C_A\n14\n97258752\nA\nC\n-0.0222000\n0.0039000\n0\n-0.0211\n0.0099\n0.03310\nNA\nNA\nTRUE\nNA\nFALSE\nbmi\nhf_allcause"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#run-the-mr",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#run-the-mr",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "Run the MR",
    "text": "Run the MR\nThis is just the plain MR of BMI on HF.\n\nres &lt;- run_mr(h)\nkable(res, caption = \"BMI:HF Mendelian randomisation\")\n\n\nBMI:HF Mendelian randomisation\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmethod\ncorrelation\nexposure\noutcome\nn_snp\nb\nb_se\np\nintercept\nint_se\nint_p\nqstat\nqstat_p\nfstat\ncondfstat\noverdispersion\nn_pc\nn_hunted\nslopehunter_pi\nslopehunter_ent\n\n\n\n\nmr_ivw\nFALSE\nbmi\nhf_allcause\n874\n0.4872820\n0.0165599\n0\n0.0000000\nNA\nNA\n1592.460\n0\n60.70091\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nmr_egger\nFALSE\nbmi\nhf_allcause\n874\n0.5367727\n0.0464790\n0\n-0.0008232\n0.0007224\n0.2544728\n1590.092\n0\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nmr_weighted_median\nFALSE\nbmi\nhf_allcause\n874\n0.5078217\n0.0236696\n0\n0.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nmr_weighted_mode\nFALSE\nbmi\nhf_allcause\n874\n0.5456300\n0.0523114\n0\n0.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#plot-mr",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#plot-mr",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "Plot MR",
    "text": "Plot MR\nPlot MR result of BMI on HF.\n\nplot_mr(h, res)"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#select-variants---mr-with-a-subset-of-bmi-variants",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#select-variants---mr-with-a-subset-of-bmi-variants",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "Select variants - MR with a subset of BMI variants",
    "text": "Select variants - MR with a subset of BMI variants\nIn the Leyden et al. 2022 paper 86 variant colocalise with adipose tissue eQTLs and 140 colocalise with brain tissue eQTLs. There is overlap between the two tissues of 43 variants. Let’s run the run of BMI on HF just using these variants - just looks like a similar version of the previous plot but with fewer points.\n\nset.seed(123)\ntissue1_varid &lt;- sample(h@snps, 140)\noverlap_varid &lt;- sample(tissue1_varid, 43)\ntissue2_varid &lt;- c(overlap_varid, sample(h@snps[!h@snps %in% overlap_varid], 86-43))\n\n# turn of variants not in either tissue\nh@index_snp[!h@snps %in% c(tissue1_varid, tissue2_varid)] &lt;- FALSE\nh@exposure &lt;- \"BMI tissue 1/2 SNPs\"\n\nres1 &lt;- run_mr(h)\nkable(res1, caption = \"BMI:HF Mendelian randomisation (Tissue 1 & 2 SNPs only)\")\n\n\nBMI:HF Mendelian randomisation (Tissue 1 & 2 SNPs only)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmethod\ncorrelation\nexposure\noutcome\nn_snp\nb\nb_se\np\nintercept\nint_se\nint_p\nqstat\nqstat_p\nfstat\ncondfstat\noverdispersion\nn_pc\nn_hunted\nslopehunter_pi\nslopehunter_ent\n\n\n\n\nmr_ivw\nFALSE\nBMI tissue 1/2 SNPs\nhf_allcause\n177\n0.5108471\n0.0363407\n0e+00\n0.0000000\nNA\nNA\n304.2402\n0\n61.28134\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nmr_egger\nFALSE\nBMI tissue 1/2 SNPs\nhf_allcause\n177\n0.5475313\n0.1037260\n1e-07\n-0.0006034\n0.0015974\n0.7056336\n303.9924\n0\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nmr_weighted_median\nFALSE\nBMI tissue 1/2 SNPs\nhf_allcause\n177\n0.5730810\n0.0494983\n0e+00\n0.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nmr_weighted_mode\nFALSE\nBMI tissue 1/2 SNPs\nhf_allcause\n177\n0.5887868\n0.1022882\n0e+00\n0.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\n\n\nplot_mr(h, res1)"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#run-multivariable-mr-unweighted",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#run-multivariable-mr-unweighted",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "Run multivariable MR (unweighted)",
    "text": "Run multivariable MR (unweighted)\nNow lets turn this into a multivariable MR situation, with BMI variants for tissues one and BMI variants for tissue 2, against HF. The results are the same, as expected, because there is no differential weighting of the betas, effectively they are just the same instrument. So far nothing new.\n\n# copy of BMI for tissue 1\nbmi_t1 &lt;- bmi\nbmi_t1@id &lt;- \"bmi tissue 1\"\nbmi_t1@trait &lt;- \"bmi tissue 1\"\n\n# copy of BMI for tissue 2\nbmi_t2 &lt;- bmi\nbmi_t2@id &lt;- \"bmi tissue 2\"\nbmi_t2@trait &lt;- \"bmi tissue 2\"\n\n# harmonise\nh_mvmr &lt;- MR(list(bmi_t1, bmi_t2), hf)\n\n# turn of variants not in either tissue\nh_mvmr@index_snp[!h_mvmr@snps %in% c(tissue1_varid, tissue2_varid)] &lt;- FALSE\n\nres2 &lt;- run_mr(h_mvmr, methods=\"mr_ivw\")\nkable(res2, caption = \"BMI:HF MV Mendelian randomisation\")\n\n\nBMI:HF MV Mendelian randomisation\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmethod\ncorrelation\nexposure\noutcome\nn_snp\nb\nb_se\np\nintercept\nint_se\nint_p\nqstat\nqstat_p\nfstat\ncondfstat\noverdispersion\nn_pc\nn_hunted\nslopehunter_pi\nslopehunter_ent\n\n\n\n\nmr_mvivw\nFALSE\nbmi tissue 1\nhf_allcause\n177\n0.5108471\n0.0363407\n0\n0\nNA\nNA\n302.5116\n0\nNA\n0\nNA\nNA\nNA\nNA\nNA\n\n\nmr_mvivw\nFALSE\nbmi tissue 2\nhf_allcause\n177\n0.5108471\n0.0363407\n0\n0\nNA\nNA\n302.5116\n0\nNA\n0\nNA\nNA\nNA\nNA\nNA\n\n\n\n\nplot_mr(h_mvmr, res2)"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#eqtl-colocalising-bmi-variants",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#eqtl-colocalising-bmi-variants",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "eQTL colocalising BMI variants",
    "text": "eQTL colocalising BMI variants\nTo separate the BMI instruments for different tissues we need to ‘change’ them somehow, in a biologically informed way. Hence weighting the betas by the best colocalisation results at each locus.\n\nNumber of colocalising variants per tissue\nLet’s first look at how many BMI variants colocalise with eQTLs from the GTEx version 10 tissues. There is quite a spread.\n\ncoloc_thresh &lt;- 0.8\n\ncoloc_results &lt;- fread(file.path(TPMR_DIR, \"output\", \"tables\", \"coloc_results.tsv.gz\"))\ncoloc_counts &lt;- (coloc_results\n  [locus_trait==\"bmi\" & grepl(\"^bmi\", trait.x) & !grepl(\"^bmi|^hf_\", trait.y) & grepl(\"protein_coding\", gene_type.y)]\n  [, num_coloc_genes := sum(pph4&gt;coloc_thresh), by=trait.y]\n  [, .SD[which.max(pph4)], by=.(locus_index_rsid, trait.y)]\n  [, .(num_coloc_genes= num_coloc_genes[1],\n       num_coloc_pph4 = sum(pph4&gt;coloc_thresh),\n       mean_pph4      = mean(pph4),\n       mean_sample_n  = mean(sample_n.y)), by=c(tissue=\"trait.y\")]\n  [, tissue := factor(tissue, levels = tissue[order(-`num_coloc_pph4`)])]\n)\n\nggplot(coloc_counts, aes(y = tissue, x = `num_coloc_pph4`)) +\n  theme_classic() +\n  geom_col(fill= \"blue\", alpha = 0.3) +\n  labs(subtitle = paste(\"coloc thresh:\", coloc_thresh), \n       x = \"Number of colocalising BMI variants\") +\n  theme(axis.title.y = element_blank())\n\n\n\n\n\n\n\n\n\n\nDeterminants of colocalisation number\nDoes the number of colocalising variants, and/or the mean PPH4 value (across all BMI variants) for each tissue, depend on eQTL sample size? Yes, this appears to be important.\n\nggplot(coloc_counts, aes(x = mean_sample_n, y = num_coloc_pph4, color = mean_pph4, size = num_coloc_genes)) +\n  geom_point() +\n  geom_text_repel(aes(label = tissue), size = 2, color=\"black\", max.overlaps = Inf) +\n  scale_color_viridis_c(option=\"mako\") +\n  theme_classic() +\n  labs(subtitle = paste(\"coloc thresh:\", coloc_thresh),\n       color = \"Mean PPH4\",\n       size = \"No. coloc genes\",\n       y = \"No. colocalising BMI variants\",\n       x = \"Sample size\")\n\n\n\n\n\n\n\n\n\n\nEffect of number of colocalising loci on MVMR result - 1\nSimple simulation - hows does the number of variants used as an instrument effect the MVMR result. Let’s hold constant the number of colocalising variants in tissue 1 (set to median: 76) and then vary the number of variants in tissue 2. For now, let’s hold the PPH4 weighting for colocalising variants at constant 0.9 and the for the non-colocalising tissue variants something low, like 0.2. We see that the MVMR estimate flips when the second tissue has more variants than the first. The tissue with higher numbers of variants has the large MVMR estimate.\n\nnum_loci &lt;- expand.grid(num_t1  = round(median(coloc_counts$num_coloc_pph4)), \n                        num_t2  = seq(min(coloc_counts$num_coloc_pph4), max(coloc_counts$num_coloc_pph4)),\n                        pph4_hi = 0.9, \n                        pph4_lo = 0.2) |&gt; as.data.table()\n\nunique_num_loci &lt;- sort(unique(c(num_loci$num_t1, num_loci$num_t2)))\nunique_num_loci &lt;- setNames(unique_num_loci, as.character(unique_num_loci))\n\nloci_indicies &lt;- lapply(unique_num_loci, function(num_l) {\n  set.seed(123)\n  sample(1:length(h_mvmr@snps), num_l, replace = FALSE)\n})\n\nmr_num_loci &lt;- num_loci[, {\n  h_tmp   &lt;- copy(h_mvmr)\n  t1_incides &lt;- loci_indicies[[as.character(num_t1)]]\n  t2_incides &lt;- loci_indicies[[as.character(num_t2)]]\n  h_tmp@index_snp &lt;- ifelse(1:length(h_tmp@snps) %in% union(t1_incides, t2_incides), TRUE, FALSE) \n  h_tmp@bx[t1_incides,1] &lt;- h_tmp@bx[t1_incides,1] * pph4_hi\n  h_tmp@bx[t2_incides,2] &lt;- h_tmp@bx[t2_incides,2] * pph4_hi\n  h_tmp@bx[setdiff(t2_incides, t1_incides),1] &lt;- h_tmp@bx[setdiff(t2_incides, t1_incides),1] * pph4_lo\n  h_tmp@bx[setdiff(t1_incides, t2_incides),2] &lt;- h_tmp@bx[setdiff(t1_incides, t2_incides),2] * pph4_lo\n  h_tmp@exposure &lt;- c(\"Tissue 1\", \"Tissue 2\")\n  r &lt;- run_mr(h_tmp, methods=\"mr_ivw\")\n}, by = .(num_t1, num_t2)]\n\nggplot(mr_num_loci[, `:=`(b_lb = b-b_se*1.96, \n                          b_ub = b+b_se*1.96)],\n       aes(x=num_t2, y=b, ymin=b_lb, ymax=b_ub, color=exposure)) +\n  geom_errorbar(width=0.2, position = position_dodge(0.2)) +\n  geom_point(position = position_dodge(0.2)) +\n  theme_bw() +\n  labs(y = \"MVMR estimate (tpBMI vs HF)\", \n       x = \"Number of tissue 2 loci\", \n       color = \"Tissue\", \n       subtitle = paste0(\"Number of loci for tissue 1 fixed at \", num_loci$num_t1[1]))\n\n\n\n\n\n\n\n\n\n\nEffect of number of colocalising loci on MVMR result - 2\nNow do the same but vary both the number of colocalising variants in tissue 1 and 2, and the percentage overlap of the instruments (grid search). We see that there has to be some difference in the number of colocalising loci and there needs to be some overlap of the loci in order to separate the MVMR results for each tissue.\n\nnum_loci &lt;- expand.grid(num_t1  = seq(min(coloc_counts$num_coloc_pph4), max(coloc_counts$num_coloc_pph4), 50), \n                        num_t2  = seq(min(coloc_counts$num_coloc_pph4), max(coloc_counts$num_coloc_pph4), 50),\n                        overlap = seq(0, 1, 0.2),\n                        seed    = 2000:2100,\n                        pph4_hi = 0.9, \n                        pph4_lo = 0.1) |&gt; as.data.table()\n\nlibrary(future)\nlibrary(furrr)\nplan(multisession)\nmr_num_loci &lt;- future_pmap_dfr(num_loci, function(num_t1, num_t2, overlap, seed, pph4_hi, pph4_lo) {\n  \n  h_tmp   &lt;- copy(h_mvmr)\n  \n  # randomly sort the BMI SNP indices\n  set.seed(seed)\n  sram_idx &lt;- sample.int(length(h_mvmr@snps))\n  \n  # indicies of the variants to use\n  overlap_n &lt;- round(min(num_t1, num_t2) * overlap)\n  t1i       &lt;- sram_idx[1:num_t1]\n  t2i       &lt;- sram_idx[(num_t1-overlap_n+1):(num_t2 + num_t1-overlap_n)]\n  t12i      &lt;- intersect(t1i, t2i)  # both tissues\n  ut1i      &lt;- setdiff(t1i, t12i)   # only tissue 1\n  ut2i      &lt;- setdiff(t2i, t12i)   # only tissue 2\n  \n  # which snps go into the instrument\n  h_tmp@index_snp &lt;- 1:length(h_mvmr@snps) %in% c(t12i, ut1i, ut2i)\n  \n  # weight tissue 1 betas\n  h_tmp@bx[ut2i,1] &lt;- h_tmp@bx[ut2i,1] * pph4_lo \n  h_tmp@bx[t1i,1]  &lt;- h_tmp@bx[t1i,1] * pph4_hi \n  \n  # weight tissue 2 betas\n  h_tmp@bx[ut1i,2] &lt;- h_tmp@bx[ut1i,2] * pph4_lo \n  h_tmp@bx[t2i,2]  &lt;- h_tmp@bx[t2i,2] * pph4_hi \n  \n  # naming\n  h_tmp@exposure &lt;- c(\"MV-beta tissue 1\", \"MV-beta tissue 2\")\n  \n  # run mr\n  r &lt;- run_mr(h_tmp, methods=\"mr_ivw\")\n  \n  r[, `:=`(num_t1   = num_t1, \n           num_t2   = num_t2, \n           num_diff = num_t1-num_t2, \n           overlap  = overlap, \n           seed     = seed, \n           pph4_lo  = pph4_lo, \n           pph4_hi  = pph4_hi)]\n  \n  return(r)\n})\n\n\nggplot(mr_num_loci[, num_diff_lab := paste0(\"Delta~nSNP[T1-T2]:~ \", num_diff)], \n       aes(x=as.factor(overlap), y=b, fill=exposure, color=num_t1)) +\n  geom_hline(yintercept = 0.0, linetype=\"dashed\", color=\"darkgray\") +\n  geom_violin(width=1, position= position_dodge(width = 0.5), color=NA) +\n  scale_x_discrete(labels = function(x) scales::percent(as.numeric(x))) +\n  theme_classic() +\n  theme(legend.position = \"top\") +\n  labs(x = \"Instrument SNP overlap (% of smaller instrument)\", \n       y = \"MVMR estimate\", \n       fill = \"Tissue\") +\n  facet_wrap(~num_diff_lab, \n             nrow = 1,\n             labeller = label_parsed)"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#bmieqtl-pph4-distributions-by-tissue",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#bmieqtl-pph4-distributions-by-tissue",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "BMI:eQTL PPH4 distributions by tissue",
    "text": "BMI:eQTL PPH4 distributions by tissue\nNow lets look at the actual distributions of the PPH4 values in each tissue, since they are not fixed like in the above analyses. Take the maximum PPH4 from genes in close proximity to each variant, in each tissue and plot the distributions - these are the weights that would be used in the tissue-partitioned MR procedure.\n\nnum_tissues &lt;- 6\ntissues_subset &lt;- levels(coloc_counts$tissue)[as.integer(seq(1, length(levels(coloc_counts$tissue)), length.out=num_tissues))] \ncoloc_subset &lt;- coloc_results[locus_trait==\"bmi\" & trait.x==\"bmi\" & (trait.y %in% tissues_subset) & grepl(\"protein_coding\", gene_type.y), .SD[which.max(pph4)], by=.(locus_index_rsid,trait.y)]\n\ndensity &lt;- coloc_subset[, {\n  den &lt;- density(pph4, n=1000)\n  .(pph4 = scales::rescale(den$x, 0:1), prob = den$y)\n}, by = c(tissue=\"trait.y\")][, tissue := factor(tissue, levels = levels(coloc_counts$tissue))]\n\nggplot(density, aes(x=pph4, y=prob, color=tissue)) +\n  theme_classic() +\n  geom_line() +\n  labs(y = \"Density\")"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#use-of-these-distributions-in-simulations",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#use-of-these-distributions-in-simulations",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "Use of these distributions in simulations",
    "text": "Use of these distributions in simulations\nIf we want ‘real-world’ PPH4 weights for use in simulations we can just sample from these density distributions. Here is a quick check to show that sampling from them replicates the shape.\n\ntissues &lt;- expand.grid(tissue = unique(density$tissue), stringsAsFactors = F) |&gt; as.data.table()\n\nset.seed(123)\n\nres_sim_density &lt;- tissues[, {\n  .(sim_pph4 = sample(density[tissue==.BY$tissue, pph4], round(length(h_mvmr@bx[,1])/2), prob = density[tissue==.BY$tissue, prob], replace = TRUE))\n}, by = .(tissue)]\n\n\nggplot(res_sim_density, aes(x=sim_pph4, color=tissue)) +\n  theme_classic() +\n  geom_density() +\n  labs(y = \"Simulated density\", \n       x = \"Simulated PPH4\", \n       color = \"Tissue\")"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#effect-different-pph4-weights",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#effect-different-pph4-weights",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "Effect different PPH4 weights",
    "text": "Effect different PPH4 weights\nWeight the BMI betas by their respective maximum PPH4 value, see how this changes the relationship between the beta for BMI and beta for HF, dependent on which tissue is providing the betas. Tissues with greater or fewer colocalising variants affect push the betas up or down more, respectively. I hold one tissue constant (reference) to more easily appreciate how the other tissue’s colocalisation characteristics affect things.\n\nref_tissue   &lt;- levels(density$tissue)[1]\ntissue_pairs &lt;- expand.grid(t1 = ref_tissue, t2 = unique(density$tissue), stringsAsFactors = F) |&gt; as.data.table()\n\nset.seed(123)\nt1_pph4 &lt;- sample(density[tissue==ref_tissue, pph4], length(h_mvmr@bx[,1]), prob = density[tissue==ref_tissue, prob], replace = TRUE)\n\nres_weighted &lt;- tissue_pairs[, {\n  h_tmp &lt;- h_mvmr\n  t2_pph4 &lt;- sample(density[tissue==.BY$t2, pph4], length(h_tmp@bx[,1]), prob = density[tissue==.BY$t2, prob], replace = TRUE)\n  h_tmp@bx[,1] &lt;- h_tmp@bx[,1] * t1_pph4\n  h_tmp@bx[,2] &lt;- h_tmp@bx[,2] * t2_pph4\n  h_tmp@index_snp &lt;- ifelse(t1_pph4&gt;coloc_thresh | t2_pph4&gt;coloc_thresh, TRUE, FALSE)\n  .(tissue   = rep(c(paste0(\"Ref: \", ref_tissue),\"Comparator\"), each=sum(h_tmp@index_snp)), \n    beta_bmi = c(h_tmp@bx[h_tmp@index_snp,1], h_tmp@bx[h_tmp@index_snp,2]), \n    beta_hf  = rep(h_tmp@by[h_tmp@index_snp],2),\n    mean_pph4_t1 = mean(t1_pph4[t1_pph4&gt;coloc_thresh | t2_pph4&gt;coloc_thresh]),\n    mean_pph4_t2 = mean(t2_pph4[t1_pph4&gt;coloc_thresh | t2_pph4&gt;coloc_thresh]), \n    rmse_pph4    = sqrt(mean((t1_pph4[t1_pph4&gt;coloc_thresh | t2_pph4&gt;coloc_thresh] - t2_pph4[t1_pph4&gt;coloc_thresh | t2_pph4&gt;coloc_thresh])^2))\n   )\n}, by = .(t1,t2)]\nres_weighted[, t2 := factor(t2, levels = unique(t2[order(-mean_pph4_t1)]))]\n\nggplot(res_weighted, aes(x=beta_bmi, y=beta_hf, color=tissue)) +\n  geom_point() +\n  geom_text(data = unique(res_weighted[grepl(\"Ref\", tissue)], by=\"t2\"), \n            aes(x = 0.0, \n                y = -0.04,\n                label = sprintf(\"Tis mPPH4=%.3f\", mean_pph4_t2)),\n            color=\"black\", size=2) +\n  geom_text(data = unique(res_weighted[!grepl(\"Ref\", tissue)], by=\"t2\"), \n            aes(x = 0.0, \n                y = -0.07,\n                label = sprintf(\"Ref mPPH4=%.3f\", mean_pph4_t1)),\n            color=\"black\", size=2) +\n  geom_smooth(method=\"lm\", se=F,fullrange = TRUE) +\n  facet_wrap(~t2, labeller = labeller(t2 = function(x) gsub(\"_\", \" \", x))) +\n  labs(subtitle = paste(\"coloc thresh:\", coloc_thresh), \n       y = \"Heart failure beta\", \n       x = \"BMI beta (PPH4-weighted)\", \n       color = \"Tissue\")"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#ivw-regression-by-different-pph4-weighting-distributions",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#ivw-regression-by-different-pph4-weighting-distributions",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "IVW regression by different PPH4 weighting distributions",
    "text": "IVW regression by different PPH4 weighting distributions\nPerform MVMR with the weighted BMI instruments. Lets look at varying the distributions that the PPH4 values are drawn from. Poorly colocalising tissues MVMR result is penalised against more highly colocalising tissues.\n\nFunction to weight betas and run MR\n\n#' @title TPMR helper function\n#' @param mrobj genepi.utils MR object (exposures BMI:BMI, outcome HF)\n#' @param density data.table of PPH4 density distributions cols: tissue | pph4 | prob\n#' @param ref character vector, tissues in density$tissue\n#' @param comp character vector, tissues in density$tissue\n#' @param coloc_thresh numeric 0-1\n#' @param rep integer, number of replications (random sampling of BMI variants into instrument)\n#' @returns data.table of MR results\n#'\ntpmr &lt;- function(obj, ref, comp, coloc_thresh, rep = 1, density = NULL, pph4 = NULL) {\n  \n  # either density or actual PPH4 values\n  stopifnot(\"Provide either denisty distributions or actual PPH4 values\" = \n              sum(sapply(list(density, pph4), is.null)) == 1)\n  stopifnot(\"Replications must be 1 if using actual PPH4 values\" = ifelse(rep &gt; 1 & !is.null(pph4), F, T))\n              \n  # run the MR for each of the exposure combinations\n  tissue_pairs &lt;- expand.grid(t1 = as.character(ref), \n                              t2 = as.character(comp),\n                              seed = 2000:(2000+rep-1),\n                              stringsAsFactors = F) |&gt; as.data.table()\n  \n  library(future)\n  library(furrr)\n  plan(multisession)\n  mr_weighted &lt;- future_pmap_dfr(tissue_pairs, function(t1, t2, seed) {\n    \n    mrobj &lt;- copy(obj)\n    \n    if (!is.null(density)) {\n    \n      # generate the PPH4 values randomly for the variants\n      set.seed(seed)\n      t1_pph4 &lt;- sample(density[tissue==t1, pph4], length(mrobj@snps), prob = density[tissue==t1, prob], replace = TRUE)\n      set.seed(seed+1)\n      t2_pph4 &lt;- sample(density[tissue==t2, pph4], length(mrobj@snps), prob = density[tissue==t2, prob], replace = TRUE)\n     \n    } else if(!is.null(pph4)) {\n      \n      chrpos &lt;- data.table(chr = as.integer(mrobj@chr), bp = mrobj@bp, t1 = t1, t2 = t2)\n      chrpos[pph4, t1.pph4 := i.pph4, on=c(\"chr\"=\"chr\",\"bp\"=\"bp\",\"t1\"=\"tissue\")]\n      chrpos[pph4, t2.pph4 := i.pph4, on=c(\"chr\"=\"chr\",\"bp\"=\"bp\",\"t2\"=\"tissue\")]\n      t1_pph4 &lt;- chrpos$t1.pph4\n      t2_pph4 &lt;- chrpos$t2.pph4\n      t1_pph4[is.na(t1_pph4)] &lt;- 0\n      t2_pph4[is.na(t2_pph4)] &lt;- 0\n      \n    }\n    \n    # based on the distribution of PPH4, which SNPs are included\n    include &lt;- ifelse(t1_pph4 &gt; coloc_thresh | t2_pph4 &gt; coloc_thresh, TRUE, FALSE)\n    \n    # update the MR object, turn off the excluded snps (@index_snp slot)\n    mrobj@bx[,1]      &lt;- mrobj@bx[,1] * t1_pph4\n    mrobj@bx[,2]      &lt;- mrobj@bx[,2] * t2_pph4\n    mrobj@index_snp   &lt;- include\n    mrobj@exposure[1] &lt;- ifelse(length(ref)==1, paste0(\"Ref: \", ref_tissue), \"Tissue 1\")\n    mrobj@exposure[2] &lt;- ifelse(length(ref)==1, \"Comparator\", \"Tissue 2\")\n    \n    # run the MR\n    r &lt;- run_mr(mrobj, methods=\"mr_ivw\")\n    \n    # add info about the instrument used\n    r[, `:=`(t1             = t1, \n             t2             = t2,\n             seed           = seed,\n             n_sig_snps     = c(sum(t1_pph4 &gt; coloc_thresh), sum(t2_pph4 &gt; coloc_thresh)), \n             n_overlap_snps = sum(t1_pph4 &gt; coloc_thresh & t2_pph4 &gt; coloc_thresh),\n             pct_t1_overlap = sum(t1_pph4 &gt; coloc_thresh & t2_pph4 &gt; coloc_thresh) / length(t1_pph4),\n             mean_pph4_t1   = mean(t1_pph4[include]),\n             mean_pph4_t2   = mean(t2_pph4[include]),\n             rmse_pph4      = sqrt(mean((t1_pph4[include] - t2_pph4[include])^2)), \n             rmse_wbeta     = sqrt(mean((mrobj@bx[,1] - mrobj@bx[,2])^2)))]\n    r[, c(\"overdispersion\", \"n_pc\", \"n_hunted\", \"slopehunter_pi\", \"slopehunter_ent\") := NULL]\n    \n  })\n  \n  return(mr_weighted)\n}\n\n\n\nDifferent PPH4 distributions against each other\n\n# run TPMR\nmr_weighted &lt;- tpmr(obj=h_mvmr, density=density, \n                    ref= unique(density$tissue), \n                    comp=unique(density$tissue), \n                    coloc_thresh=0.8, \n                    rep = 100)\n\n# reorder for plotting \nmr_weighted[, mean_pph4_t1_lab := round(mean(mean_pph4_t1),2), by=.(t1)]\nmr_weighted[, mean_pph4_t2_lab := round(mean(mean_pph4_t2),2), by=.(t2)]\nmr_weighted[, mean_n_sig_snps := round(mean(mean_pph4_t2),0), by=.(t1,t2)]\n\nggplot(mr_weighted, \n       aes(x=as.factor(mean_pph4_t2_lab), y=b, color=exposure)) +\n  geom_boxplot() +\n  theme_bw() +\n  labs(y = \"MVMR estimate\", x = \"T2 mean PPH4\", color = \"Tissue\") +\n  facet_wrap(~ as.factor(mean_pph4_t1_lab), \n             labeller = labeller(`as.factor(mean_pph4_t1_lab)`=function(x) paste0(\"T1 mean PPH4: \",x)))\n\n\n\n\n\n\n\nggplot(mr_weighted[, .(b=mean(b)), by=.(t1,t2,exposure)][, .(b_diff=b[1]-b[2]), by=.(t1,t2)], \n       aes(y=t1, x=t2, fill=b_diff)) +\n  geom_tile() +\n  scale_fill_gradient2() +\n  theme(axis.text.x  = element_text(angle=45, hjust=1)) +\n  labs(y = \"Tissue 1\", x = \"Tissue 2\", fill = \"T1-T2 beta diff\")"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#all-tissue-pairs-mr-actual-pph4-values",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#all-tissue-pairs-mr-actual-pph4-values",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "All tissue pairs MR (actual PPH4 values)",
    "text": "All tissue pairs MR (actual PPH4 values)\nNow let’s use the real data and do the all GTEx tissue against all other GTEx tissues. The poorly colocalising tissues have lower MVMR estimates against more highly coloclising tissues.\n\ntissue_pph4_vals &lt;- coloc_results[locus_trait==\"bmi\" & \n                                    trait.x==\"bmi\" & \n                                    gene_type.y==\"protein_coding\", \n                                  .SD[which.max(pph4)], \n                                  by=.(locus_index_rsid, tissue=trait.y), \n                                  .SDcols=c(\"chr\", \"bp\", \"pph4\")]\ntissue_pph4_vals &lt;- tidyr::complete(tissue_pph4_vals, locus_index_rsid, tissue) |&gt; as.data.table()\n\nmr_actual &lt;- tpmr(obj=h_mvmr, pph4=tissue_pph4_vals, \n                  ref= unique(tissue_pph4_vals$tissue), \n                  comp=unique(tissue_pph4_vals$tissue), \n                  coloc_thresh=0.8)\n\nggplot((mr_actual\n        [coloc_counts, t1_n := i.mean_sample_n, on=c(\"t1\"=\"tissue\")]\n        [coloc_counts, t2_n := i.mean_sample_n, on=c(\"t2\"=\"tissue\")]\n        [, `:=`(b_diff     = b[exposure==\"Tissue 1\"]-b[exposure==\"Tissue 2\"],\n                snp_diff   = n_sig_snps[exposure==\"Tissue 1\"]-n_sig_snps[exposure==\"Tissue 2\"],\n                pph4_diff  = mean_pph4_t1-mean_pph4_t2, \n                nsamp_diff = t1_n - t2_n), by=.(t1,t2)]\n        [, `:=`(t1 = factor(t1, levels = unique(t1[order(-b_diff)])),\n                t2 = factor(t2, levels = unique(t1[order(-b_diff)])))]),\n       aes(y=t1, x=t2, fill=b_diff)) +\n  geom_tile() +\n  scale_fill_gradient2() +\n  theme(axis.text.x  = element_text(angle=45, hjust=1)) +\n  labs(y = \"Tissue 1\", x = \"Tissue 2\", fill = \"T1-T2 beta diff\")\n\n\n\n\n\n\n\n\n\nMVMR estimates depend on difference in instrument size (which also depends on difference in sample size)\nPlot the different between MVMR estimates from a the 2-exposure MVMR procedure above - i.e. how separated are the effects attributed to each tissue. Is the magnitude of the separation related to the relative number of SNPs in each instrument, and does this depend on the sample size.\n\nt1_highlight &lt;- c(\"cortex\", \"frontal_cortex\", \"hippocampus\", \"hypothalamus\")\nt2_highlight &lt;- c(\"subcut_adipose\")\nggplot((mr_actual\n        [coloc_counts, t1_n := i.mean_sample_n, on=c(\"t1\"=\"tissue\")]\n        [coloc_counts, t2_n := i.mean_sample_n, on=c(\"t2\"=\"tissue\")]\n        [, `:=`(b_diff     = b[exposure==\"Tissue 1\"]-b[exposure==\"Tissue 2\"],\n                snp_diff   = n_sig_snps[exposure==\"Tissue 1\"]-n_sig_snps[exposure==\"Tissue 2\"],\n                pph4_diff  = mean_pph4_t1-mean_pph4_t2, \n                nsamp_diff = t1_n - t2_n), by=.(t1,t2)]\n       ),\n       aes(y=b_diff, x=snp_diff, color=nsamp_diff)) +\n  geom_hline(yintercept = 0.0, linetype=\"dotted\", color=\"grey\") +\n  geom_vline(xintercept = 0.0, linetype=\"dotted\", color=\"grey\") +\n  geom_point(alpha=0.3) +\n  geom_label_repel(data = unique(mr_actual[t1 %in% t1_highlight & t2 %in% t2_highlight][, lab := paste0(t1,\"/\",t2)], by=\"lab\"), aes(label=lab), max.overlaps=Inf, nudge_y=0.5, color=\"black\") +\n  scale_color_viridis_c(option=\"magma\") +\n  geom_smooth(method=\"lm\", se=FALSE, color=\"red\") +\n  theme_classic2() +\n  theme(legend.position = \"top\") +\n  labs(y = expression(Delta[T1-T2]~MVMR~estimate), \n       x = expression(Delta[T1-T2]~No.~coloc~SNPs), \n       color = expression(Delta[T1-T2]~Tissue~sample~size))"
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#interpretation-so-far",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#interpretation-so-far",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "Interpretation so far",
    "text": "Interpretation so far\nIs the MVMR estimate mostly related to the difference in the relative number of colocalising SNPs in tissue A vs. tissue B? The tissue with fewer colocalising SNPs may be overpowered in the MVMR by the tissue with a greater number of colocalising SNPs, since number of colocalising SNPs is related to sample size of the eQTL dataset, is the MVMR estimate just a function of sample size? We not clearly, as despite the trend there are numerous tissues which show the reverse pattern - e.g. brain tissues where the sample size and number of colocalising loci is actually less than for subcutaneous adipose tissue, yet the MVMR result yeilds a larger contribution from the brain tissue instrument (i.e. the points live in the North-West quantrant of the plot above). Let’s look at why this happens."
  },
  {
    "objectID": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#brain-vs-adipose-tissue",
    "href": "posts/2025-01-10-tissue-partitioned-mvmr/index.html#brain-vs-adipose-tissue",
    "title": "Tissue-partitioned BMI instrument procedure",
    "section": "Brain vs adipose tissue",
    "text": "Brain vs adipose tissue\nLets break down the characteristics of the brain and adipose tissue-partitioned BMI instruments.\n\nNumber of colocalising loci\n\nggplot((coloc_counts\n        [tissue %in% c(t1_highlight, t2_highlight)]\n        [, tissue_class := ifelse(tissue %in% t1_highlight, \"Brain\", \"Adipose\")]\n        ), aes(x = tissue, y = `num_coloc_pph4`, fill = tissue_class)) +\n  theme_classic2() +\n  geom_col(alpha = 0.5) +\n  labs(subtitle = paste(\"coloc thresh:\", coloc_thresh), \n       y = \"Number of colocalising BMI variants\") +\n  theme(axis.title.x = element_blank(), \n        axis.text.x = element_text(angle=45, hjust=1)) +\n  guides(fill = \"none\") +\n  facet_wrap(~tissue_class, scales = \"free_x\")\n\n\n\n\n\n\n\n\n\n\nDistribution of PPH4\n\nbrain_adip_coloc &lt;- coloc_results[locus_trait==\"bmi\" & trait.x==\"bmi\" & (trait.y %in% c(t1_highlight,t2_highlight)) & grepl(\"protein_coding\", gene_type.y), .SD[which.max(pph4)], by=.(locus_index_rsid,trait.y)]\nbmi_gwas_data &lt;- as.data.table(h_mvmr)[, chr:= as.integer(chr)]\nbrain_adip_coloc[bmi_gwas_data, `:=`(bmi_beta = i.bx, weighted_bmi_beta = pph4*i.bx), on=.(chr,bp)]\n\nggplot(brain_adip_coloc, aes(x=pph4, color=trait.y)) +\n  theme_classic() +\n  geom_density() +\n  labs(y = \"Density\", x = \"PPH4\", color=\"Tissue\")\n\n\n\n\n\n\n\n\n\n\nDistribution of weighted BMI betas (all)\n\nggplot(brain_adip_coloc[, locus_index_rsid:=factor(locus_index_rsid, levels=unique(locus_index_rsid[order(-weighted_bmi_beta)]))], \n       aes(x=locus_index_rsid, y=trait.y, fill=weighted_bmi_beta)) +\n  theme_classic2() +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(y = \"Density\", x = \"Weighted BMI beta\", color=\"Tissue\")"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "",
    "section": "",
    "text": "Order By\n      Default\n      \n        Title\n      \n      \n        Date - Oldest\n      \n      \n        Date - Newest\n      \n      \n        Modified - Oldest\n      \n      \n        Modified - Newest\n      \n    \n  \n    \n      \n      \n    \n\n\n\n\n\n\n\n\n\n\nforest-fire model\n\n7 min\n\n\nshiny\n\napp\n\nmodel\n\n\n\n\n2025-06-04\n\n\n\n\n2025-06-04\n\n\n\n\n\n\n\n\n\n\n\nCV\n\n1 min\n\n\ninformation\n\n\n\n\n2025-06-04\n\n\n\n\n2025-06-04\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2025-06-04-test/index.html",
    "href": "posts/2025-06-04-test/index.html",
    "title": "Test",
    "section": "",
    "text": "Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see https://quarto.org."
  },
  {
    "objectID": "posts/2025-06-04-test/index.html#meet-quarto",
    "href": "posts/2025-06-04-test/index.html#meet-quarto",
    "title": "Test",
    "section": "Meet Quarto",
    "text": "Meet Quarto\nQuarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see https://quarto.org."
  },
  {
    "objectID": "posts/2025-06-04-test/index.html#meet-the-penguins",
    "href": "posts/2025-06-04-test/index.html#meet-the-penguins",
    "title": "Test",
    "section": "Meet the penguins",
    "text": "Meet the penguins\n\nThe penguins data from the palmerpenguins package contains size measurements for 344 penguins from three species observed on three islands in the Palmer Archipelago, Antarctica.\nThe plot below shows the relationship between flipper and bill lengths of these penguins."
  },
  {
    "objectID": "posts/forest-fire/index.html",
    "href": "posts/forest-fire/index.html",
    "title": "template",
    "section": "",
    "text": "rm(list=ls())\nset.seed(821)\n\nlibrary(shiny)\nlibrary(ggplot2)\nlibrary(reshape2)\n\n# functions ====\n# Initialize the grid \n# 0 = empty, 1 = tree, 2 = fire, 3 = cooling (empty but can't grow tree yet)\ndata_init_forest &lt;- function(size) {\n  list(\n    grid = matrix(0, nrow = size, ncol = size),\n    stats = list(\n      total_trees = 0,\n      fires_started = 0,\n      trees_burned = 0\n    )\n  )\n}\n\n# Update empty cells to trees based on probability\ngrow_trees &lt;- function(forest, p_growth) {\n  grid &lt;- forest$grid\n  # Only grow trees in cells that are empty (0) but not cooling (3)\n  new_trees &lt;- which(grid == 0 & runif(length(grid)) &lt; (p_growth / 1000))\n  \n  if (length(new_trees) &gt; 0) {\n    grid[new_trees] &lt;- 1\n    forest$stats$total_trees &lt;- forest$stats$total_trees + length(new_trees)\n  }\n  \n  forest$grid &lt;- grid\n  return(forest)\n}\n\n# Start fires in trees based on probability\nstart_fires &lt;- function(forest, p_fire) {\n  grid &lt;- forest$grid\n  new_fires &lt;- which(grid == 1 & runif(length(grid)) &lt; (p_fire / 1000))\n  \n  if (length(new_fires) &gt; 0) {\n    grid[new_fires] &lt;- 2\n    forest$stats$fires_started &lt;- forest$stats$fires_started + length(new_fires)\n    forest$stats$trees_burned &lt;- forest$stats$trees_burned + length(new_fires)\n  }\n  \n  forest$grid &lt;- grid\n  return(forest)\n}\n\n# Spread fire to adjacent trees and handle cooling\nspread_fire &lt;- function(forest) {\n  grid &lt;- forest$grid\n  size &lt;- nrow(grid)\n  \n  # Find all fires\n  fires &lt;- which(grid == 2, arr.ind = TRUE)\n  new_grid &lt;- grid\n  \n  # Spread fire to adjacent trees\n  if (nrow(fires) &gt; 0) {\n    for (i in 1:nrow(fires)) {\n      x &lt;- fires[i, 1]\n      y &lt;- fires[i, 2]\n      \n      # Check adjacent cells (up, down, left, right)\n      neighbors &lt;- rbind(\n        c(x - 1, y), c(x + 1, y),\n        c(x, y - 1), c(x, y + 1)\n      )\n      \n      # Only consider valid grid coordinates\n      valid_neighbors &lt;- neighbors[\n        neighbors[, 1] &gt; 0 & neighbors[, 1] &lt;= size &\n          neighbors[, 2] &gt; 0 & neighbors[, 2] &lt;= size, \n      ]\n      \n      # Convert adjacent trees to fires\n      for (n in 1:nrow(valid_neighbors)) {\n        if (grid[valid_neighbors[n, 1], valid_neighbors[n, 2]] == 1) {\n          new_grid[valid_neighbors[n, 1], valid_neighbors[n, 2]] &lt;- 2\n          forest$stats$trees_burned &lt;- forest$stats$trees_burned + 1\n        }\n      }\n    }\n  }\n  \n  # Convert fires to cooling state\n  new_grid[grid == 2] &lt;- 3\n  # Convert cooling state to empty\n  new_grid[grid == 3] &lt;- 0\n  \n  forest$grid &lt;- new_grid\n  return(forest)\n}\n\n\n# testing ====\n# ui ====\nui &lt;- fluidPage(\n  titlePanel(\"Forest Fire Model\"),\n  sidebarLayout(\n    sidebarPanel(\n      sliderInput(\"p_growth\", \"Tree Growth Probability (%)\", \n                  min = 0, max = 10, value = 5),\n      sliderInput(\"p_fire\", \"Fire Start Probability (%)\", \n                  min = 0, max = 10, value = 1),\n      actionButton(\"reset\", \"Reset Forest\"),\n      hr(),\n      h4(\"Statistics:\"),\n      textOutput(\"iterationCount\"),\n      textOutput(\"totalTrees\"),\n      textOutput(\"firesStarted\"),\n      textOutput(\"treesBurned\")\n    ),\n    mainPanel(\n      plotOutput(\"forestPlot\")\n    )\n  )\n)\n\n# server ====\nserver &lt;- function(input, output, session) {\n  size &lt;- 100\n  forest &lt;- reactiveVal(data_init_forest(size))\n  iteration &lt;- reactiveVal(0)\n  \n  autoUpdate &lt;- reactiveTimer(200)\n  \n  observeEvent(input$reset, {\n    forest(data_init_forest(size))\n    iteration(0)\n  })\n  \n  observeEvent(autoUpdate(), {\n    current_forest &lt;- forest()\n    iter &lt;- iteration() + 1\n    \n    # First grow new trees (only in empty, non-cooling cells)\n    current_forest &lt;- grow_trees(current_forest, input$p_growth)\n    \n    # Then start new fires\n    current_forest &lt;- start_fires(current_forest, input$p_fire)\n    \n    # Finally spread existing fires and handle cooling\n    current_forest &lt;- spread_fire(current_forest)\n    \n    forest(current_forest)\n    iteration(iter)\n  })\n  \n  output$forestPlot &lt;- renderPlot({\n    forest_data &lt;- melt(forest()$grid)\n    colnames(forest_data) &lt;- c(\"x\", \"y\", \"state\")\n    \n    ggplot(forest_data, aes(x, y, fill = factor(state))) +\n      geom_tile() +\n      scale_fill_manual(values = c(\"black\", \"green3\", \"red2\", \"gray20\")) +\n      guides(fill = \"none\") +\n      theme_minimal() +\n      theme(axis.text = element_blank(),\n            axis.title = element_blank(),\n            axis.ticks = element_blank(),\n            panel.grid = element_blank())\n  })\n  \n  # Statistics outputs\n  output$iterationCount &lt;- renderText({\n    paste(\"Iteration:\", iteration())\n  })\n  \n  output$totalTrees &lt;- renderText({\n    paste(\"Total Trees grown:\", forest()$stats$total_trees)\n  })\n  \n  output$firesStarted &lt;- renderText({\n    paste(\"Fires started:\", forest()$stats$fires_started)\n  })\n  \n  output$treesBurned &lt;- renderText({\n    paste(\"Trees burned:\", forest()$stats$trees_burned)\n  })\n}\n\n# launch ===="
  },
  {
    "objectID": "posts/forestfire-model/index.html",
    "href": "posts/forestfire-model/index.html",
    "title": "forest-fire model",
    "section": "",
    "text": "Forest-fire models are not models of forest fires. Instead they’re models through which we can explore dynamic systems. This is a simple R Shiny app that takes input probabilities for trees and fires; the app is rendered here and was inspired by an artist residency.\nFirst we set the environment, including N_grid which is the size of our grid - N_grid = 1000 is equivalent to a 100x100 grid - and make a set of functions.\n\n# environment ====\nlibrary(shiny)\nlibrary(ggplot2)\nlibrary(reshape2)\nN_grid &lt;- 1000\n\nThe 1st function is to create a grid (the land where trees grow)\n\n# Initialize the grid \n# 0 = empty, 1 = tree, 2 = fire, 3 = cooling (empty but can't grow tree yet)\ndata_init_forest &lt;- function(size) {\n  list(\n    grid = matrix(0, nrow = size, ncol = size),\n    stats = list(\n      total_trees = 0,\n      fires_started = 0,\n      trees_burned = 0\n    )\n  )\n}\n\nThe 2nd function is for tree growth. We specify that trees can only grow on empty cells.\n\n# Update empty cells to trees based on probability\ngrow_trees &lt;- function(forest, p_growth) {\n  grid &lt;- forest$grid\n  # Only grow trees in cells that are empty (0) but not cooling (3)\n  new_trees &lt;- which(grid == 0 & runif(length(grid)) &lt; (p_growth / N_grid))\n  \n  if (length(new_trees) &gt; 0) {\n    grid[new_trees] &lt;- 1\n    forest$stats$total_trees &lt;- forest$stats$total_trees + length(new_trees)\n  }\n  \n  forest$grid &lt;- grid\n  return(forest)\n}\n\nThe 3rd function is for fires to start. We specify that fires can only start on cells with a tree.\n\n# Start fires in trees based on probability\nstart_fires &lt;- function(forest, p_fire) {\n  grid &lt;- forest$grid\n  new_fires &lt;- which(grid == 1 & runif(length(grid)) &lt; (p_fire / N_grid))\n  \n  if (length(new_fires) &gt; 0) {\n    grid[new_fires] &lt;- 2\n    forest$stats$fires_started &lt;- forest$stats$fires_started + length(new_fires)\n    forest$stats$trees_burned &lt;- forest$stats$trees_burned + length(new_fires)\n  }\n  \n  forest$grid &lt;- grid\n  return(forest)\n}\n\nThe 4th function is for fires to spread. We specify that fires can only spread to adjacent cells if there is a tree already present. We also add that after one iteration a fire is converted to a cooling state (i.e., it can not be a tree or a new fire in the next iteration) to prevent a fire-loop and that a cooling state is converted to an empty state.\n\n# Spread fire to adjacent trees and handle cooling\nspread_fire &lt;- function(forest) {\n  grid &lt;- forest$grid\n  size &lt;- nrow(grid)\n  \n  # Find all fires\n  fires &lt;- which(grid == 2, arr.ind = TRUE)\n  new_grid &lt;- grid\n  \n  # Spread fire to adjacent trees\n  if (nrow(fires) &gt; 0) {\n    for (i in 1:nrow(fires)) {\n      x &lt;- fires[i, 1]\n      y &lt;- fires[i, 2]\n      \n      # Check adjacent cells (up, down, left, right)\n      neighbors &lt;- rbind(\n        c(x - 1, y), c(x + 1, y),\n        c(x, y - 1), c(x, y + 1)\n      )\n      \n      # Only consider valid grid coordinates\n      valid_neighbors &lt;- neighbors[\n        neighbors[, 1] &gt; 0 & neighbors[, 1] &lt;= size &\n          neighbors[, 2] &gt; 0 & neighbors[, 2] &lt;= size, \n      ]\n      \n      # Convert adjacent trees to fires\n      for (n in 1:nrow(valid_neighbors)) {\n        if (grid[valid_neighbors[n, 1], valid_neighbors[n, 2]] == 1) {\n          new_grid[valid_neighbors[n, 1], valid_neighbors[n, 2]] &lt;- 2\n          forest$stats$trees_burned &lt;- forest$stats$trees_burned + 1\n        }\n      }\n    }\n  }\n  \n  # Convert fires to cooling state\n  new_grid[grid == 2] &lt;- 3\n  # Convert cooling state to empty\n  new_grid[grid == 3] &lt;- 0\n  \n  forest$grid &lt;- new_grid\n  return(forest)\n}\n\nWe make a simple sidebar layout Shiny app so we can adjust probabilities and see the model change dynamically. We also add some monitoring and print metrics so we can see the number of iterations and the cumulative number of trees grown, fires started, and trees burnt.\n\n# testing ====\n# ui ====\nui &lt;- fluidPage(\n  titlePanel(\"Forest Fire Model\"),\n  sidebarLayout(\n    sidebarPanel(\n      sliderInput(\"p_growth\", \"Tree Growth Probability (%)\", \n                  min = 0, max = 10, value = 5),\n      sliderInput(\"p_fire\", \"Fire Start Probability (%)\", \n                  min = 0, max = 10, value = 1),\n      actionButton(\"reset\", \"Reset Forest\"),\n      hr(),\n      h4(\"Statistics:\"),\n      textOutput(\"iterationCount\"),\n      textOutput(\"totalTrees\"),\n      textOutput(\"firesStarted\"),\n      textOutput(\"treesBurned\")\n    ),\n    mainPanel(\n      plotOutput(\"forestPlot\")\n    )\n  )\n)\n\n# server ====\nserver &lt;- function(input, output, session) {\n  size &lt;- 100\n  forest &lt;- reactiveVal(data_init_forest(size))\n  iteration &lt;- reactiveVal(0)\n  \n  autoUpdate &lt;- reactiveTimer(200)\n  \n  observeEvent(input$reset, {\n    forest(data_init_forest(size))\n    iteration(0)\n  })\n  \n  observeEvent(autoUpdate(), {\n    current_forest &lt;- forest()\n    iter &lt;- iteration() + 1\n    \n    # First grow new trees (only in empty, non-cooling cells)\n    current_forest &lt;- grow_trees(current_forest, input$p_growth)\n    \n    # Then start new fires\n    current_forest &lt;- start_fires(current_forest, input$p_fire)\n    \n    # Finally spread existing fires and handle cooling\n    current_forest &lt;- spread_fire(current_forest)\n    \n    forest(current_forest)\n    iteration(iter)\n  })\n  \n  output$forestPlot &lt;- renderPlot({\n    forest_data &lt;- melt(forest()$grid)\n    colnames(forest_data) &lt;- c(\"x\", \"y\", \"state\")\n    \n    ggplot(forest_data, aes(x, y, fill = factor(state))) +\n      geom_tile() +\n      scale_fill_manual(values = c(\"black\", \"green3\", \"red2\", \"gray20\")) +\n      guides(fill = \"none\") +\n      theme_minimal() +\n      theme(axis.text = element_blank(),\n            axis.title = element_blank(),\n            axis.ticks = element_blank(),\n            panel.grid = element_blank())\n  })\n  \n  # Statistics outputs\n  output$iterationCount &lt;- renderText({\n    paste(\"Iteration:\", iteration())\n  })\n  \n  output$totalTrees &lt;- renderText({\n    paste(\"Total Trees grown:\", forest()$stats$total_trees)\n  })\n  \n  output$firesStarted &lt;- renderText({\n    paste(\"Fires started:\", forest()$stats$fires_started)\n  })\n  \n  output$treesBurned &lt;- renderText({\n    paste(\"Trees burned:\", forest()$stats$trees_burned)\n  })\n}\n\n# launch ====\nshinyApp(ui, server)\n\n \nThis is an iframe of the rendered app; it takes a while to load and is choppy; it is interactive but mostly its for illustration"
  },
  {
    "objectID": "posts/CV/index.html",
    "href": "posts/CV/index.html",
    "title": "CV",
    "section": "",
    "text": "CV - Matthew Lee\n\n\n\n\n\n\n\n\nMatthew Lee\n\n\nInternational Agency for Research on Cancer, World Health Organisation, Lyon, France\n\n\nORCiD | GitHub | Biostatistics and Data Integration Team\n\n\n\n\n\nEducation\n\n\n2017-2022\n\n\nPhD, Population Health Sciences\n\n\n Medical Research Council Integrative Epidemiology Unit at the University of Bristol\n\n\nThesis: What lies behind the causal impact of body mass index level and change on human health? Added value from complementary study design and deep metabolomics phenotyping\n\n\n2014-2015\n\n\nMSc, Biotechnology - Distinction (top of class)\n\n\nUniversity of Essex, Colchester, United Kingdom\n\n\nAwards: The Biotechnology Prize for best overall achievement\n\n\nDissertation: The antigenicity of protective antigen epitopes following immunisation\n\n\n2011-2013\n\n\nBSc (Hons), Sports and Exercise Science - 2:1\n\n\nUniversity of Essex, Colchester, United Kingdom\n\n\nDissertation: Does running barefoot alter the gait in habitual shod runners\n\n\n\n\n\nResearch positions\n\n\n04/2024-present\n\n\nPostdoctoral Scientist\n\n\nBiostatistics and Data Integration Team, International Agency for Research on Cancer, World Health Organisation, Lyon, France\n\n\n04/2022-present\n\n\nHonorary Senior Research Associatie\n\n\nBristol Medical School, University of Bristol, United Kingdom\n\n\n04/2022-04/2024\n\n\nPostdoctoral Scientist\n\n\nMetabolic Epidemiology Team, International Agency for Research on Cancer, World Health Organisation, Lyon, France\n\n\n01/2017-08/2017\n\n\nResearch Laboratory Technician\n\n\nColorectal Tumour Biology Group, University of Bristol, Bristol, United Kingdom\n\n\n06/2016-12/2016\n\n\nResearch Technician\n\n\nIGFs and Metabolic Endocrinology Group, University of Bristol, Bristol, United Kingdom\n\n\n01/2016-06/2016\n\n\nWork experience\n\n\nIGFs and Metabolic Endocrinology Group, University of Bristol, Bristol, United Kingdom\n\n\n04/2015-07/2015\n\n\nVisiting Scientist\n\n\nTyphoid and Cholera research Group, Division of Bacteriology, National Institute for Biological Standards and Control, United Kingdom\n\n\n\n\n\nResearch experience\n\n\nI’m a genetic epidemiologist using Mendelian randomization, metabolomics, and composite measures to investigate disease development. I have performed genome-wide association studies, conducted a systematic review and meta-analysis of Mendelian randomization studies, and developed a visualisation tool for metabolomics analyses. I’ve led and managed researchers, taught PhD students, post-docs and clinicians, and written successful grants. In addition, I have experience in molecular and cell biology of tumour microenvironments and have worked closely with wet-lab scientists.\n\n\n\n\n\n\n\n\n\nPublications, selected: Scholar/ORCiD\n\n\nLee MA, et al. Adiposity, metabolites and endometrial cancer risk: Mendelian randomization and Observational analyses. medRxiv, pp.2024-04.\n\n\nLee MA, et al. A proteogenomic analysis of the adiposity colorectal cancer relationship identifies GREM1 as a probable mediator. medRxiv, pp.2024-02.\n\n\nLee MA, et al. Systematic review and meta-analyses: What has the application of Mendelian randomization told us about the causal effect of adiposity on health outcomes? Wellcome Open Res. 2023 Sep 13;7:308. doi: 10.12688/wellcomeopenres.18657.2. PMID: 38974363; PMCID: PMC11225060.\n\n\nHughes DA, Taylor K, McBride N, Lee MA, Mason D, Lawlor DA, Timpson NJ, Corbin LJ. metaboprep: an R package for preanalysis data description and processing. Bioinformatics. 2022 Mar 28;38(7):1980-1987. doi: 10.1093/bioinformatics/btac059. PMID: 35134881; PMCID: PMC8963298.\n\n\nBattram T, Yousefi P, Crawford G, Prince C, Sheikhali Babaei M, Sharp G, Hatcher C, Vega-Salas MJ, Khodabakhsh S, Whitehurst O, Langdon R, Mahoney L, Elliott HR, Mancano G, Lee MA, Watkins SH, Lay AC, Hemani G, Gaunt TR, Relton CL, Staley JR, Suderman M. The EWAS Catalog: a database of epigenome-wide association studies. Wellcome Open Res. 2022 May 31;7:41. doi: 10.12688/wellcomeopenres.17598.2. PMID: 35592546; PMCID: PMC9096146.\n\n\nLee MA, et al. Common variation at 16p11.2 is associated with glycosuria in pregnancy: findings from a genome-wide association study in European women. Hum Mol Genet. 2020 Jul 29;29(12):2098-2106. doi: 10.1093/hmg/ddaa054. PMID: 32227112; PMCID: PMC7390941.\n\n\n\n\n\nInvited talks\n\n\n2025\n\n\nIdentification of proteomic markers of colorectal cancer risk. Integrative Epidemiology of Obesity Group, University of Bristol, Bristol, United Kingdom\n\n\n2025\n\n\nProteomic analysis of colorectal cancer risk across two prospective cohorts. Cancer Screening Prevention Research Group, Imperial College London, London, United Kingdom\n\n\n2024\n\n\nUsing triangulation to investigate the role of circulating proteins in multiple myeloma. CHARGE Mendelian Randomization working group\n\n\n2024\n\n\nCirculating proteomics and colorectal cancer: Somascan analyses in the EPIC cohort. DISCERN annual meeting, Lyon, France\n\n\n2024\n\n\nA proteogenomic analysis of the adiposity colorectal cancer relationship identifies GREM1 as a probable mediator. Scientific Council annual meeting, International Agency for Resarch on Cancer\n\n\n2024\n\n\nA proteogenomic analysis of the adiposity colorectal cancer relationship identifies GREM1 as a probable mediator. EPIC annual meeting, Brighton, United Kingdom\n\n\n2020\n\n\nEpiViz: an implementation of Circos plots for epidemiologists. Data Science Seminar Series, University of Essex\n\n\n\n\n\nConference abstracts\n\n\n2025\n\n\nPoster: Proteomic analysis of colorectal cancer risk across two prospective cohorts. American Association for Cancer Research, Chicago, Illinois, United States of America\n\n\n2024\n\n\nOral, presented by co-author: The Problem with Proteins: What Mendelian Randomization Can (and Can’t) Reveal. International Genetic Epidemiology Society\n\n\nOral: Proteomic analyses of colorectal cancer in the European Prospective Investigation into Cancer and Nutrition. Cancer Research Network Early Career Researchers’ Event, University of Bristol\n\n\nPoster: Adiposity, proteins, and colorectal cancer: mendelian randomization and colocalization analyses with prospective analyses in the European Prospective Investigation into Cancer. Mendelian randomization conference, Bristol\n\n\n2023\n\n\nPoster: Adiposity, proteins, and colorectal cancer: mendelian randomization and colocalization analyses with prospective analyses in the European Prospective Investigation into Cancer. Early Career Scientists Association, International Agency for Cancer Research\n\n\n2019\n\n\nOral: Metabolite profiling of diseases. Faculty of Health Sciences research showcase, University of Bristol\n\n\nPoster: Metabolite profiling of multiple measures of adiposity: A Mendelian randomization analysis. Faculty of Health Sciences research showcase, University of Bristol\n\n\nPoster: What lies behind the causal impact of body mass index level and change on human health? Mendelian randomization conference, Bristol\n\n\nPoster: Metabolite profiling of multiple measures of adiposity: A Mendelian randomization analysis. Metabolomics, The Hague, The Netherlands\n\n\n2018\n\n\nPoster: What lies behind the causal impact of body mass index level and change on human health? GW4 BioMed Congress, University of Bath\n\n\nPoster: What lies behind the causal impact of body mass index level and change on human health? Population Health Science Institute symposium, University of Bristol\n\n\n\n\n\n\n\n\nTeaching\n\n\nI have been an Instructor on several courses run by the Bristol Medical School. These courses are designed for PhD students, researchers, and clinicians. I have taught the Mendelian Randomization course twice a year since 2019, I have also taught this as a residential course at the University of Pavia in 2019.\n\n\nOngoing\n\n\nMendelian randomization. University of Bristol, United Kingdom. “Matthew was a great tutor and answered all our questions”. “Great last day, practical with Matt and Ryan were so good”. (~10 hours of lectures/practicals)\n\n\nGenetic Epidemiology. University of Bristol, United Kingdom. (2 hours of practicals)\n\n\nIntroduction to data visualisation and web applications using R. University of Bristol, United Kingdom. (~6 hours of lectures/practicals)\n\n\nIntroduction to R. University of Bristol, United Kingdom. (~4 hours of pratcicals)\n\n\n2021\n\n\nIntroduction to Epidemiology. University of Bristol, United Kingdom. (1 hour lecture)\n\n\nCausal inference in Epidemiology using Mendelian randomization. Wellcome Trust Kenya Medical Research Institute, Kenya. (~6 hours of lectures/practicals)\n\n\n2020\n\n\nMendelian randomization. National University of Ireland Galway, Reupublic of Ireland. (~10 hours of lectures/practicals)\n\n\n2019\n\n\nIntroduction to Mendelian randomization. Conference workshop, Mendelian Randomization, Bristol, United Kingdom. (~4 hours of lectures/practicals)\n\n\nCausal inference and Mendelian randomization. Department of Brain and Behavioural Sciences, University of Pavia, Italy. (~15 hours of lectures/practicals)\n\n\n\n\n\nGrants / Awards\n\n\n2020\n\n\nCo-applicant: Engineering and Physical Sciences Research Council: £27,522\n\n\nLead: GW4 Transition to Post-doc fellowship: £8,661.38\n\n\n2019\n\n\nLead: Widening Participation, University of Bristol: £3,000\n\n\nCo-applicant: Engineering and Physical Sciences Research Council: £14,985\n\n\nLead: Medical Research Council Integrative Epidemiology Unit: £1,000\n\n\nLead: Alumni Foundation, University of Bristol: £1,000\n\n\nLead: Widening Participation, University of Bristol: £2,000\n\n\n2018\n\n\nLead: Medical Research Council: £5,000\n\n\nLead: Medical Research Council Integrative Epidemiology Unit: £1,000\n\n\n\n\n\n\n\n\n\nOther experience\n\n\nPublic engagement\n\n\nI run a project (CREATE-REACT.com) working with artists to engage diverse audiences with research through creative events, exhibitions, and participatory art. We have received over £50,000 in grants for this work.\n\n\nI have worked on numerous projects working with schools, creatives, industry partners, youth centres, and independent adults. This has included delivering science stands at festivals (e.g. Greenman, Wales), working with libraries to deliver a science film festival, managing academics to deliver a Neuroscience festival to 2,000 students, and leading a science technology engineering and maths fair with 30 industry and academic stands.\n\n\nCommitments\n\n\nPeer-review: Scientific Reports, Obesity, Obesity reviews\n\n\nco-chair: Early Career Scientists Association, International Agency for Research on Cancer\n\n\nMember: Data Science Steering Group, International Agency for Research on Cancer\n\n\nConference committee: Mendelian Randomization; 2019, 2021. Responsible for abstract review\n\n\nConference committee: Bristol Population Health Sciences Institute Symposium; 2018. Provided administrative support\n\n\nConference committee: Bristol Population Health Sciences Symposium; 2018. Responsible for networking events.\n\n\nStudent representative: Bristol Medical School, University of Bristol; 2018-present. Initiated consultation on parental leave and sick leave for PhD students\n\n\nStudent representative: MRC GW4 BioMed PhD Programme; 2020-present. Gather and present student feedback to management board meetings.\n\n\nFestival committee: Bristol Neuroscience festival. Responsible for recruitment and management of 20 exhibition stands.\n\n\n\n\n\nTraining\n\n\n2024\n\n\nMassive Genomic Data: Statistical and Bioinformatic Advances: Institut national de la santé et de la recherche médicale\n\n\nEnrichment Analysis: Swiss Institute for Bioinformatics\n\n\nIntroduction to multi-omics data integration and visualisation: European Molecular Biology Lab, European Bioinformatics Institute\n\n\n2019\n\n\nMethods for analysing complex trait genome-wide associations study data: University College London\n\n\nStatistical Methods for Mediation Analysis: University of Bristol\n\n\nCausal Inference in Epidemiology: Concepts and Methods: University of Bristol\n\n\nMultiple Imputation for Missing Data: University of Bristol\n\n\nAnalysis of Repeated Measures: University of Bristol\n\n\n2018\n\n\nStarting to Teach for PGRs - Small Group Teachin: University of Bristol\n\n\nBest programming practices for open science: University of Cardiff\n\n\nIntroduction to Linear and Logistic Regression: University of Bristol\n\n\nAdvanced Epigenetic Epidemiology: University of Bristol\n\n\nMendelian randomization: University of Bristol\n\n\nIntroduction to statistics: University of Bristol\n\n\n2017\n\n\nResearch Data and Confidentiality: Medical Research Council\n\n\nResearch and Human Tissue Legislation: Medical Research Council\n\n\nGood Research Practice: Medical Research Council"
  },
  {
    "objectID": "posts/CV/index.html#education",
    "href": "posts/CV/index.html#education",
    "title": "forest-fire model",
    "section": "Education",
    "text": "Education\n\n2017-2022\n\n\nPhD, Population Health Sciences\n\n\n Medical Research Council Integrative Epidemiology Unit at the University of Bristol\n\n\nThesis: What lies behind the causal impact of body mass index level and change on human health? Added value from complementary study design and deep metabolomics phenotyping\n\n\n2014-2015\n\n\nMSc, Biotechnology - Distinction (top of class)\n\n\nUniversity of Essex, Colchester, United Kingdom\n\n\nAwards: The Biotechnology Prize for best overall achievement\n\n\nDissertation: The antigenicity of protective antigen epitopes following immunisation\n\n\n2011-2013\n\n\nBSc (Hons), Sports and Exercise Science - 2:1\n\n\nUniversity of Essex, Colchester, United Kingdom\n\n\nDissertation: Does running barefoot alter the gait in habitual shod runners"
  },
  {
    "objectID": "posts/CV/index.html#research-positions",
    "href": "posts/CV/index.html#research-positions",
    "title": "forest-fire model",
    "section": "Research positions",
    "text": "Research positions\n\n04/2024-present\n\n\nPostdoctoral Scientist\n\n\nBiostatistics and Data Integration Team, International Agency for Research on Cancer, World Health Organisation, Lyon, France\n\n\n04/2022-present\n\n\nHonorary Senior Research Associatie\n\n\nBristol Medical School, University of Bristol, United Kingdom\n\n\n04/2022-04/2024\n\n\nPostdoctoral Scientist\n\n\nMetabolic Epidemiology Team, International Agency for Research on Cancer, World Health Organisation, Lyon, France\n\n\n01/2017-08/2017\n\n\nResearch Laboratory Technician\n\n\nColorectal Tumour Biology Group, University of Bristol, Bristol, United Kingdom\n\n\n06/2016-12/2016\n\n\nResearch Technician\n\n\nIGFs and Metabolic Endocrinology Group, University of Bristol, Bristol, United Kingdom\n\n\n01/2016-06/2016\n\n\nWork experience\n\n\nIGFs and Metabolic Endocrinology Group, University of Bristol, Bristol, United Kingdom\n\n\n04/2015-07/2015\n\n\nVisiting Scientist\n\n\nTyphoid and Cholera research Group, Division of Bacteriology, National Institute for Biological Standards and Control, United Kingdom"
  },
  {
    "objectID": "posts/CV/index.html#research-experience",
    "href": "posts/CV/index.html#research-experience",
    "title": "forest-fire model",
    "section": "Research experience",
    "text": "Research experience\n\nI’m a genetic epidemiologist using Mendelian randomization, metabolomics, and composite measures to investigate disease development. I have performed genome-wide association studies, conducted a systematic review and meta-analysis of Mendelian randomization studies, and developed a visualisation tool for metabolomics analyses. I’ve led and managed researchers, taught PhD students, post-docs and clinicians, and written successful grants. In addition, I have experience in molecular and cell biology of tumour microenvironments and have worked closely with wet-lab scientists."
  },
  {
    "objectID": "posts/CV/index.html#publications-selected-scholarorcid",
    "href": "posts/CV/index.html#publications-selected-scholarorcid",
    "title": "forest-fire model",
    "section": "Publications, selected: Scholar/ORCiD",
    "text": "Publications, selected: Scholar/ORCiD\n\nLee MA, et al. Adiposity, metabolites and endometrial cancer risk: Mendelian randomization and Observational analyses. medRxiv, pp.2024-04.\n\n\nLee MA, et al. A proteogenomic analysis of the adiposity colorectal cancer relationship identifies GREM1 as a probable mediator. medRxiv, pp.2024-02.\n\n\nLee MA, et al. Systematic review and meta-analyses: What has the application of Mendelian randomization told us about the causal effect of adiposity on health outcomes? Wellcome Open Res. 2023 Sep 13;7:308. doi: 10.12688/wellcomeopenres.18657.2. PMID: 38974363; PMCID: PMC11225060.\n\n\nHughes DA, Taylor K, McBride N, Lee MA, Mason D, Lawlor DA, Timpson NJ, Corbin LJ. metaboprep: an R package for preanalysis data description and processing. Bioinformatics. 2022 Mar 28;38(7):1980-1987. doi: 10.1093/bioinformatics/btac059. PMID: 35134881; PMCID: PMC8963298.\n\n\nBattram T, Yousefi P, Crawford G, Prince C, Sheikhali Babaei M, Sharp G, Hatcher C, Vega-Salas MJ, Khodabakhsh S, Whitehurst O, Langdon R, Mahoney L, Elliott HR, Mancano G, Lee MA, Watkins SH, Lay AC, Hemani G, Gaunt TR, Relton CL, Staley JR, Suderman M. The EWAS Catalog: a database of epigenome-wide association studies. Wellcome Open Res. 2022 May 31;7:41. doi: 10.12688/wellcomeopenres.17598.2. PMID: 35592546; PMCID: PMC9096146.\n\n\nLee MA, et al. Common variation at 16p11.2 is associated with glycosuria in pregnancy: findings from a genome-wide association study in European women. Hum Mol Genet. 2020 Jul 29;29(12):2098-2106. doi: 10.1093/hmg/ddaa054. PMID: 32227112; PMCID: PMC7390941."
  },
  {
    "objectID": "posts/CV/index.html#invited-talks",
    "href": "posts/CV/index.html#invited-talks",
    "title": "forest-fire model",
    "section": "Invited talks",
    "text": "Invited talks\n\n2025\n\n\nIdentification of proteomic markers of colorectal cancer risk. Integrative Epidemiology of Obesity Group, University of Bristol, Bristol, United Kingdom\n\n\n2025\n\n\nProteomic analysis of colorectal cancer risk across two prospective cohorts. Cancer Screening Prevention Research Group, Imperial College London, London, United Kingdom\n\n\n2024\n\n\nUsing triangulation to investigate the role of circulating proteins in multiple myeloma. CHARGE Mendelian Randomization working group\n\n\n2024\n\n\nCirculating proteomics and colorectal cancer: Somascan analyses in the EPIC cohort. DISCERN annual meeting, Lyon, France\n\n\n2024\n\n\nA proteogenomic analysis of the adiposity colorectal cancer relationship identifies GREM1 as a probable mediator. Scientific Council annual meeting, International Agency for Resarch on Cancer\n\n\n2024\n\n\nA proteogenomic analysis of the adiposity colorectal cancer relationship identifies GREM1 as a probable mediator. EPIC annual meeting, Brighton, United Kingdom\n\n\n2020\n\n\nEpiViz: an implementation of Circos plots for epidemiologists. Data Science Seminar Series, University of Essex"
  },
  {
    "objectID": "posts/CV/index.html#conference-abstracts",
    "href": "posts/CV/index.html#conference-abstracts",
    "title": "forest-fire model",
    "section": "Conference abstracts",
    "text": "Conference abstracts\n\n2025\n\n\nPoster: Proteomic analysis of colorectal cancer risk across two prospective cohorts. American Association for Cancer Research, Chicago, Illinois, United States of America\n\n\n2024\n\n\nOral, presented by co-author: The Problem with Proteins: What Mendelian Randomization Can (and Can’t) Reveal. International Genetic Epidemiology Society\n\n\nOral: Proteomic analyses of colorectal cancer in the European Prospective Investigation into Cancer and Nutrition. Cancer Research Network Early Career Researchers’ Event, University of Bristol\n\n\nPoster: Adiposity, proteins, and colorectal cancer: mendelian randomization and colocalization analyses with prospective analyses in the European Prospective Investigation into Cancer. Mendelian randomization conference, Bristol\n\n\n2023\n\n\nPoster: Adiposity, proteins, and colorectal cancer: mendelian randomization and colocalization analyses with prospective analyses in the European Prospective Investigation into Cancer. Early Career Scientists Association, International Agency for Cancer Research\n\n\n2019\n\n\nOral: Metabolite profiling of diseases. Faculty of Health Sciences research showcase, University of Bristol\n\n\nPoster: Metabolite profiling of multiple measures of adiposity: A Mendelian randomization analysis. Faculty of Health Sciences research showcase, University of Bristol\n\n\nPoster: What lies behind the causal impact of body mass index level and change on human health? Mendelian randomization conference, Bristol\n\n\nPoster: Metabolite profiling of multiple measures of adiposity: A Mendelian randomization analysis. Metabolomics, The Hague, The Netherlands\n\n\n2018\n\n\nPoster: What lies behind the causal impact of body mass index level and change on human health? GW4 BioMed Congress, University of Bath\n\n\nPoster: What lies behind the causal impact of body mass index level and change on human health? Population Health Science Institute symposium, University of Bristol"
  },
  {
    "objectID": "posts/CV/index.html#teaching",
    "href": "posts/CV/index.html#teaching",
    "title": "forest-fire model",
    "section": "Teaching",
    "text": "Teaching\n\nI have been an Instructor on several courses run by the Bristol Medical School. These courses are designed for PhD students, researchers, and clinicians. I have taught the Mendelian Randomization course twice a year since 2019, I have also taught this as a residential course at the University of Pavia in 2019.\n\n\nOngoing\n\n\nMendelian randomization. University of Bristol, United Kingdom. “Matthew was a great tutor and answered all our questions”. “Great last day, practical with Matt and Ryan were so good”. (~10 hours of lectures/practicals)\n\n\nGenetic Epidemiology. University of Bristol, United Kingdom. (2 hours of practicals)\n\n\nIntroduction to data visualisation and web applications using R. University of Bristol, United Kingdom. (~6 hours of lectures/practicals)\n\n\nIntroduction to R. University of Bristol, United Kingdom. (~4 hours of pratcicals)\n\n\n2021\n\n\nIntroduction to Epidemiology. University of Bristol, United Kingdom. (1 hour lecture)\n\n\nCausal inference in Epidemiology using Mendelian randomization. Wellcome Trust Kenya Medical Research Institute, Kenya. (~6 hours of lectures/practicals)\n\n\n2020\n\n\nMendelian randomization. National University of Ireland Galway, Reupublic of Ireland. (~10 hours of lectures/practicals)\n\n\n2019\n\n\nIntroduction to Mendelian randomization. Conference workshop, Mendelian Randomization, Bristol, United Kingdom. (~4 hours of lectures/practicals)\n\n\nCausal inference and Mendelian randomization. Department of Brain and Behavioural Sciences, University of Pavia, Italy. (~15 hours of lectures/practicals)"
  },
  {
    "objectID": "posts/CV/index.html#grants-awards",
    "href": "posts/CV/index.html#grants-awards",
    "title": "forest-fire model",
    "section": "Grants / Awards",
    "text": "Grants / Awards\n\n2020\n\n\nCo-applicant: Engineering and Physical Sciences Research Council: £27,522\n\n\nLead: GW4 Transition to Post-doc fellowship: £8,661.38\n\n\n2019\n\n\nLead: Widening Participation, University of Bristol: £3,000\n\n\nCo-applicant: Engineering and Physical Sciences Research Council: £14,985\n\n\nLead: Medical Research Council Integrative Epidemiology Unit: £1,000\n\n\nLead: Alumni Foundation, University of Bristol: £1,000\n\n\nLead: Widening Participation, University of Bristol: £2,000\n\n\n2018\n\n\nLead: Medical Research Council: £5,000\n\n\nLead: Medical Research Council Integrative Epidemiology Unit: £1,000"
  },
  {
    "objectID": "posts/CV/index.html#other-experience",
    "href": "posts/CV/index.html#other-experience",
    "title": "forest-fire model",
    "section": "Other experience",
    "text": "Other experience\n\nPublic engagement\n\n\nI run a project (CREATE-REACT.com) working with artists to engage diverse audiences with research through creative events, exhibitions, and participatory art. We have received over £50,000 in grants for this work.\n\n\nI have worked on numerous projects working with schools, creatives, industry partners, youth centres, and independent adults. This has included delivering science stands at festivals (e.g. Greenman, Wales), working with libraries to deliver a science film festival, managing academics to deliver a Neuroscience festival to 2,000 students, and leading a science technology engineering and maths fair with 30 industry and academic stands.\n\n\nCommitments\n\n\nPeer-review: Scientific Reports, Obesity, Obesity reviews\n\n\nco-chair: Early Career Scientists Association, International Agency for Research on Cancer\n\n\nMember: Data Science Steering Group, International Agency for Research on Cancer\n\n\nConference committee: Mendelian Randomization; 2019, 2021. Responsible for abstract review\n\n\nConference committee: Bristol Population Health Sciences Institute Symposium; 2018. Provided administrative support\n\n\nConference committee: Bristol Population Health Sciences Symposium; 2018. Responsible for networking events.\n\n\nStudent representative: Bristol Medical School, University of Bristol; 2018-present. Initiated consultation on parental leave and sick leave for PhD students\n\n\nStudent representative: MRC GW4 BioMed PhD Programme; 2020-present. Gather and present student feedback to management board meetings.\n\n\nFestival committee: Bristol Neuroscience festival. Responsible for recruitment and management of 20 exhibition stands."
  },
  {
    "objectID": "posts/CV/index.html#training",
    "href": "posts/CV/index.html#training",
    "title": "forest-fire model",
    "section": "Training",
    "text": "Training\n\n2024\n\n\nMassive Genomic Data: Statistical and Bioinformatic Advances: Institut national de la santé et de la recherche médicale\n\n\nEnrichment Analysis: Swiss Institute for Bioinformatics\n\n\nIntroduction to multi-omics data integration and visualisation: European Molecular Biology Lab, European Bioinformatics Institute\n\n\n2019\n\n\nMethods for analysing complex trait genome-wide associations study data: University College London\n\n\nStatistical Methods for Mediation Analysis: University of Bristol\n\n\nCausal Inference in Epidemiology: Concepts and Methods: University of Bristol\n\n\nMultiple Imputation for Missing Data: University of Bristol\n\n\nAnalysis of Repeated Measures: University of Bristol\n\n\n2018\n\n\nStarting to Teach for PGRs - Small Group Teachin: University of Bristol\n\n\nBest programming practices for open science: University of Cardiff\n\n\nIntroduction to Linear and Logistic Regression: University of Bristol\n\n\nAdvanced Epigenetic Epidemiology: University of Bristol\n\n\nMendelian randomization: University of Bristol\n\n\nIntroduction to statistics: University of Bristol\n\n\n2017\n\n\nResearch Data and Confidentiality: Medical Research Council\n\n\nResearch and Human Tissue Legislation: Medical Research Council\n\n\nGood Research Practice: Medical Research Council"
  }
]